# ì¸ë¬¼ ëª¨ë“œ ì‚¬ì§„ ì„¸ê·¸ë©˜í…Œì´ì…˜ ê°œì„  ì „ëµ

## 1. ëª©í‘œ

<aside>
ğŸ’¡

í˜„ì¬ ì¸ë¬¼ ëª¨ë“œ ì‚¬ì§„ì„ ìƒì„±í•  ë•Œ ë°œìƒí•˜ëŠ” **ê²½ê³„ ì¸ì‹ ì˜¤ë¥˜ ë° ë°°ê²½ ë¸”ëŸ¬ ì²˜ë¦¬ ì˜¤ë¥˜**ë¥¼ í•´ê²°í•˜ê³ , ë”ìš± ì •êµí•œ ì¸ë¬¼ ëª¨ë“œ íš¨ê³¼ë¥¼ ì œê³µí•˜ëŠ” ì†”ë£¨ì…˜ì„ êµ¬ì¶•í•œë‹¤.

</aside>

### í‰ê°€ ê¸°ì¤€

1. **ì¸ë¬¼ ëª¨ë“œ ì‚¬ì§„ì„ ì„±ê³µì ìœ¼ë¡œ ì œì‘**
    - ì•„ì›ƒí¬ì»¤ì‹±(Blur) ì²˜ë¦¬ëœ ì¸ë¬¼ ì‚¬ì§„ê³¼ ë°°ê²½ ì „í™˜(í¬ë¡œë§ˆí‚¤) ì‚¬ì§„ì„ ìƒì„±
2. **ë¬¸ì œì ì„ ì •í™•íˆ ì§€ì **
    - ê¸°ì¡´ ëª¨ë¸ì´ ì¸ì‹í•˜ëŠ” ì˜¤ë¥˜ ë¶„ì„
3. **ì†”ë£¨ì…˜ ì œì‹œ**
    - Semantic Segmentation Maskì˜ ì˜¤ë¥˜ë¥¼ ë³´ì™„í•˜ëŠ” ìµœì ì˜ ë°©ë²•ë¡  ë„ì¶œ

---

## 2. ë¬¸ì œì  ë¶„ì„

í˜„ì¬ DeepLabV3ì™€ SAMì„ ì¡°í•©í•˜ì—¬ ì¸ë¬¼ ëª¨ë“œë¥¼ ìƒì„±í•˜ë ¤ í•˜ì§€ë§Œ, ë‹¤ìŒê³¼ ê°™ì€ ë¬¸ì œê°€ ë°œìƒí•œë‹¤.

1. **DeepLabV3ì˜ ê°ì²´ ê²€ì¶œ í•œê³„**
    - DeepLabV3ê°€ ë°°ê²½ê³¼ ì‚¬ëŒì„ ì •í™•íˆ êµ¬ë¶„í•˜ì§€ ëª»í•˜ëŠ” ê²½ìš° ë°œìƒ
    - ì‚¬ëŒ ê·¼ì²˜ì˜ ì‚¬ë¬¼(ì˜ˆ: ì˜ì, ê°€ë°©)ì´ ì‚¬ëŒê³¼ í•¨ê»˜ í¬í•¨ë˜ëŠ” ì˜¤ë¥˜ ë°œìƒ
2. **SAMì˜ í´ë˜ìŠ¤ ì •ë³´ ë¶€ì¡±**
    - SAMì€ ì„¸ê·¸ë©˜í…Œì´ì…˜ì„ ìˆ˜í–‰í•˜ì§€ë§Œ, í´ë˜ìŠ¤ ì •ë³´ê°€ ì—†ì–´ ì¸ë¬¼ ì‚¬ì§„ ëª¨ë“œë¥¼ ë§Œë“¤ê¸° í˜ë“¦

---

## 3. í•´ê²° ë°©ì•ˆ ìˆœì„œë„

```
1. ë” ì •êµí•œ ê°ì²´ ë¶„ë¦¬ (Object Segmentation ê°œì„ )
   â†’ DeepLabV3 ëŒ€ì‹  SegFormerì™€ ConvNeXtë¥¼ ê²°í•©í•˜ì—¬ ì‚¬ëŒ ê°ì²´ ê²€ì¶œ ì„±ëŠ¥ í–¥ìƒ

2. ë” ìì—°ìŠ¤ëŸ¬ìš´ Blur ì²˜ë¦¬ (Depth & Edge-aware Blur)
   â†’ Guided Filtering ë° Adaptive Gaussian Blurì„ ì ìš©í•˜ì—¬ ê²½ê³„ ë¶€ë“œëŸ½ê²Œ ì¡°ì •
```

---

## 4. í•´ê²° ë°©ë²•ë¡ 

### SegFormer + SAM + RefineNet ì•™ìƒë¸” ëª¨ë¸ ì œì•ˆ

### **1. ê°ì²´ ë¶„ë¦¬ ê°œì„  (Object Segmentation ê°œì„ )**

**SegFormer + ConvNeXt ì ìš©**

- ê¸°ì¡´ DeepLabV3 ëŒ€ì‹  **SegFormer(Swin Transformer ê¸°ë°˜) + ConvNeXt** ì¡°í•©
- SegFormer: ë„“ì€ ë¬¸ë§¥ì„ ì´í•´í•˜ë©´ì„œ ì‘ì€ ê°ì²´ë„ ì¸ì‹ ê°€ëŠ¥
- ConvNeXt: CNN ê¸°ë°˜ìœ¼ë¡œ ë¹ ë¥´ê³  ì •í™•í•œ íŠ¹ì§• ì¶”ì¶œ ê°€ëŠ¥

ì¥ì : ì‚¬ëŒê³¼ ë°°ê²½ì„ ì •í™•íˆ ë¶„ë¦¬í•˜ê³ , ì‘ì€ ì‚¬ë¬¼ê¹Œì§€ ì •êµí•˜ê²Œ ê²€ì¶œ ê°€ëŠ¥

> ì¶œì²˜ :
https://arxiv.org/abs/2105.15203?utm_source=chatgpt.com
https://github.com/NVlabs/SegFormer
https://www.youtube.com/watch?v=t79E4gq4L-A&t=15s
https://arxiv.org/abs/2201.03545?utm_source=chatgpt.com
https://github.com/facebookresearch/ConvNeXt
> 

---

### **2. ê²½ê³„ ë³´ì •**

**RefineNetì„ í™œìš©í•œ ì„¸ë¶€ ê²½ê³„ ì¡°ì •**

- **Conditional Random Field(CRF)** ê¸°ë°˜ ê²½ê³„ ë³´ì • ì ìš©
- SAMì´ ì˜ëª» ë¶„í• í•œ ì˜ì—­ì„ **RefineNetì´ ë³´ì •í•˜ì—¬ ìì—°ìŠ¤ëŸ¬ìš´ ë¶„í•  ìˆ˜í–‰**

> ì¶œì²˜ : 
https://pubmed.ncbi.nlm.nih.gov/38495379/
> 

---

### **3. Blur ì²˜ë¦¬ ê°œì„ **

**Guided Filtering ê¸°ë°˜ Blur**

- Blur ì ìš© ì „ì— **Guided Filteringì„ í™œìš©í•˜ì—¬ ê²½ê³„ë¥¼ ìœ ì§€**
    - Guided Image Filteringì€ ê¸°ì¡´ í•„í„°ë“¤ì˜ ë‹¨ì ì„ í•´ê²°í•œ ìƒˆë¡œìš´ ì´ë¯¸ì§€ í•„í„°ë§ ê¸°ë²•.
    - **ì—£ì§€ë¥¼ ìœ ì§€í•˜ë©´ì„œë„ ë¶€ë“œëŸ½ê²Œ ë…¸ì´ì¦ˆë¥¼ ì œê±°í•  ìˆ˜ ìˆëŠ” ì„±ì§ˆ**ì„ ê°€ì§€ë©°, ì—°ì‚° ì†ë„ê°€ ë¹ ë¥´ê³  ì •í™•ë„ê°€ ë†’ë‹¤.
    - ê¸°ì¡´ Bilateral Filterì™€ ë‹¬ë¦¬ **Gradient Reversal(ì—£ì§€ ë°˜ì „ í˜„ìƒ)ì´ ë°œìƒí•˜ì§€ ì•Šìœ¼ë©°**, ë‹¤ì–‘í•œ ì˜ìƒ ì²˜ë¦¬ ë° ì»´í“¨í„° ê·¸ë˜í”½ ì‘ìš©ì— íš¨ê³¼ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
    - ëŒ€í‘œì ìœ¼ë¡œ **ë…¸ì´ì¦ˆ ì œê±°, ë””í…Œì¼ ê°•ì¡°, HDR ì••ì¶•, ì´ë¯¸ì§€ ë§¤íŒ…, í—¤ì´ì¦ˆ ì œê±°, ì—…ìƒ˜í”Œë§** ë“±ì— í™œìš©ëœë‹¤.
- Adaptive Gaussian Blur ì ìš©í•˜ì—¬ ê¹Šì´ ì •ë³´(Depth) ê¸°ë°˜ìœ¼ë¡œ ë°°ê²½ì„ ë¶€ë“œëŸ½ê²Œ íë¦¼

 ì¥ì : ë¨¸ë¦¬ì¹´ë½, ì‹¤ë£¨ì—£ì´ ë¶€ë“œëŸ½ê²Œ ì²˜ë¦¬ë˜ë©´ì„œ ë°°ê²½ê³¼ ë¶„ë¦¬ë¨

> ì¶œì²˜ : 
https://journals.mmupress.com/index.php/jiwe/article/view/781?utm_source=chatgpt.com
https://people.csail.mit.edu/kaiming/publications/eccv10guidedfilter.pdf?utm_source=chatgpt.com
> 

---

## 5. ì„±ëŠ¥ í‰ê°€ ë° ì‹œê°í™”

### **1. ì„±ëŠ¥ í‰ê°€ ê¸°ì¤€**

| í‰ê°€ ì§€í‘œ | ì„¤ëª… |
| --- | --- |
| **IoU (Intersection over Union)** | ì‚¬ëŒì´ í¬í•¨ëœ ì˜ì—­ì´ ì •í™•íˆ ê²€ì¶œë˜ì—ˆëŠ”ì§€ í™•ì¸ |
| **mIoU (Mean IoU)** | ì—¬ëŸ¬ í´ë˜ìŠ¤ì—ì„œ í‰ê·  IoU ë¹„êµ |
| **Boundary F1-score** | ê²½ê³„ë¥¼ ì •í™•í•˜ê²Œ êµ¬ë³„í–ˆëŠ”ì§€ í‰ê°€ |
| **Pixel Accuracy** | ì „ì²´ í”½ì…€ ì¤‘ ì •í™•íˆ ë¶„ë¥˜ëœ í”½ì…€ ë¹„ìœ¨ |

mIoU ê³„ì‚° ì˜ˆì‹œ

| í´ë˜ìŠ¤ | ì‹¤ì œ ì •ë‹µ í¬ê¸° | ëª¨ë¸ì´ ì˜ˆì¸¡í•œ í¬ê¸° | ê²¹ì¹œ ë¶€ë¶„ (IoU) |
| --- | --- | --- | --- |
| **ì‚¬ëŒ** | 100 í”½ì…€ | 90 í”½ì…€ | **0.85** (85%) |
| **ì˜ì** | 50 í”½ì…€ | 40 í”½ì…€ | **0.75** (75%) |
| **ë°°ê²½** | 200 í”½ì…€ | 180 í”½ì…€ | **0.90** (90%) |

mIoU = (0.85 + 0.75 + 0.90) / 3 = 0.83

> ì¶œì²˜ :
https://modulabs.co.kr/blog/iou-intersection-over-union-%EA%B0%9D%EC%B2%B4-%ED%83%90%EC%A7%80-%ED%8F%89%EA%B0%80-%EC%A7%80%ED%91%9C
> 

### **2. ë¹„êµ ì‹¤í—˜ ë° ì‹œê°í™”**

**IoU ì„±ëŠ¥ ë¹„êµ ê·¸ë˜í”„**

```python
import matplotlib.pyplot as plt
import numpy as np

# IoU ê°’ ì„¤ì •
iou_baseline = [0.72, 0.68, 0.75]
iou_improved = [0.82, 0.78, 0.85]
categories = ["Person", "Dog", "Tree"]
x = np.arange(len(categories))

plt.figure(figsize=(8, 5))
plt.bar(x - 0.2, iou_baseline, 0.4, label="Baseline", color="gray")
plt.bar(x + 0.2, iou_improved, 0.4, label="Improved", color="blue")
plt.xticks(x, categories)
plt.xlabel("Categories")
plt.ylabel("IoU Score")
plt.title("IoU Comparison")
plt.legend()
plt.show()
```

**ì˜¤ë²„ë ˆì´ ë¹„êµ (Before vs After)**

```python
import cv2
import matplotlib.pyplot as plt

# ì›ë³¸, ê¸°ì¡´ ì„¸ê·¸ë©˜í…Œì´ì…˜, ê°œì„ ëœ ì„¸ê·¸ë©˜í…Œì´ì…˜ ì´ë¯¸ì§€ ë¡œë“œ
original = cv2.imread("original.jpg")
baseline = cv2.imread("baseline.jpg", 0)
improved = cv2.imread("improved.jpg", 0)

fig, axes = plt.subplots(1, 3, figsize=(15, 5))
axes[0].imshow(cv2.cvtColor(original, cv2.COLOR_BGR2RGB))
axes[0].set_title("Original")
axes[1].imshow(baseline, cmap="gray")
axes[1].set_title("Baseline")
axes[2].imshow(improved, cmap="gray")
axes[2].set_title("Improved")

for ax in axes:
    ax.axis("off")
plt.show()
```

---

## 6. ìµœì¢… ê²°ë¡ 

- ê¸°ì¡´ DeepLabV3 + SAMì˜ í•œê³„ë¥¼ ê·¹ë³µí•˜ê¸° ìœ„í•´ **SegFormer + SAM + RefineNet ì•™ìƒë¸” ëª¨ë¸**ì„ ì œì•ˆ
- ê²½ê³„ë¥¼ ë” ë¶€ë“œëŸ½ê³  ìì—°ìŠ¤ëŸ½ê²Œ ì²˜ë¦¬í•˜ëŠ” í›„ì²˜ë¦¬ ê¸°ë²• ì ìš©
- **Guided Filtering** ë° **Adaptive Gaussian Blur**ë¥¼ ì ìš©í•˜ì—¬ ë°°ê²½ì„ ë” ìì—°ìŠ¤ëŸ½ê²Œ íë¦¬ê²Œ ì²˜ë¦¬